(function(){var a={modes:{wysiwyg:1,source:1},canUndo:false,exec:function(j){var h=j.getData();var f=j.config;var e,c,i,l;if(l=window.screen){e=Math.round(l.width*0.8);c=Math.round(l.height*0.7);i=Math.round(l.width*0.1)}else{e=640;c=420;i=80}var d=$("#contexte").val();var k="";if(d){var g=d.match(/^#(.*)$/);if(g){d=g[1];k="id"}else{g=d.match(/^\.(.*)$/);if(g){d=g[1];k="class"}}}else{d=""}$.post(CKEDITOR.spipurl+"?page=preview"+(d?"&contexte="+encodeURI(d):"")+(k?"&attr="+encodeURI(k):""),{preview:h},function(p){var n="";var o=p.replace(/(<head[^>]*>)/,'$1<base href="'+CKEDITOR.ckdirRacine+'"/>');var m=window.open("",null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+e+",height="+c+",left="+i);m.document.write(o);m.document.close()})}};var b="zpippreview";CKEDITOR.plugins.add(b,{init:function(c){c.addCommand(b,a);c.ui.addButton("ZpipPreview",{label:c.lang.preview+" ZPIP",command:b,icon:this.path+"preview.png"})}})})();