function insertTag(e,g,a,h,c){var f=false;var d="spip";for(var b in c){if((c[b][0]=="/"+a)||((c[b][0]==a)&&(c[b][6]==1))){f=true}if(c[b][0]==a){d=c[b][7]}}e.focus();e.fire("saveSnapshot");e.insertHtml("&lt;"+g+(h?(d=="html"?" ":"|")+h:"")+"&gt;"+(f?"&lt;/"+a+"&gt;":""));e.fire("saveSnapshot")}CKEDITOR.plugins.add("spipmodeles",{lang:["fr"],requires:["richcombo"],init:function(d){var b=d.config,h=d.lang.spipmodeles;CKEDITOR.dialog.add("spipmodelesDlg",this.path+"dialogs/spipmodeles.js");var g=new CKEDITOR.dialogCommand("spipmodelesDlg");d.addCommand("spipmodelesCmd",g);var a=[];try{var c=$.ajax({url:CKEDITOR.spipurl+"?page=spiptags-json",async:false,global:false,dataType:"json"}).responseText;a=$.parseJSON(c)}catch(f){a=[]}d.ui.addRichCombo("SpipModeles",{label:h.label,title:h.title,voiceLabel:h.voiceLabel,className:"cke_format",multiSelect:false,panel:{css:[b.contentsCss,CKEDITOR.getUrl(d.skinPath+"editor.css")],voiceLabel:h.voiceLabel},init:function(){this.startGroup(h.groupName);for(var e in a){if(!a[e][0].match(/^\//)){var i,j,k;j=a[e][0];k=a[e][1];if(k==""){k=j}i=a[e][2];if(i==""){i=k}this.add(j,k,i)}}},onClick:function(j){var i,e=j;d.openDialog("spipmodelesDlg",function(){this.tag_requested=j;this.tags=a})}})}});